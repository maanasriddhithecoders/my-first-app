<!DOCTYPE html>
<html>

<head>
  <title class="title">Take Me Places ! Taxi service for Senior Events near you </title>
  <style>
    .hide {
      display: none;
    }

    .event-img {
      width: 300px;
      height: 300px;      
    }
.title{
  color:deepskyblue;
  font-size: xx-large;
}
    .name {
      color: green;
      font-weight:bolder;
      font-size:xx-large;
    }

    .details {
      color: blue;
      font-weight: bold;
      font-size: medium;
      display: none;
      border-style: groove;
      border-color: coral;

    }

    .picture {
      border-width: 1em;
      border-style: groove;
      border-color: coral;
      width: 300px;
      height: 300px;
    }

    .taxi{
      font-size: xx-large;
      font-style: oblique;
      color:orangered;
      border: 2em;
      
    }
    .taxi-image{
      height: 10em;
      width: 10em;
    }
    .call-taxi{
      border: 0.2em;
      border-style: dotted;
      font-size: xx-large;
      color: darkblue;
    }
    .display_content {
      display: block;
    }
    .sms {
      display: none;
    }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
  <div class="container">
    <h1 align="center" class="title">Hello ! Senior Events near you </h1>
    <br />
    <div align="center">
      <button type="button" name="load_taxi_data" id="load_taxi_data" class="btn btn-info">Show Taxi List</button>
      <button type="button" name="load_event_data" id="load_event_data" class="btn btn-info">Show Events List</button>
    </div>
    <br />
    <div id="employee_table">

    </div>
    <div id="taxi_table">

    </div>

    <p>Request a taxi</p>
    <div>
        
      <!--Add few elements to the form-->

      <div>
          <p>Name:</p> <input type="text" id="txtName" placeholder="Enter your name" />
      </div>
      <div>
          <p></p><input type="datetime-local" id="txtAge" placeholder="Select Date and Time" />
      </div>
      <div>
          <input type="text" id="txtEmail" placeholder="Enter your mobile number" />
      </div>
      <div>
          <select id="selCountry">
              <option selected value="">-- Choose the City --</option>
              <option value="Kildeer">Kildeer</option>
              <option value="Barrington">Barrington</option>
              <option value="Vernon Hills">Vernon Hills</option>
              <option value="Long Grove">Long Grove</option>

          </select>
      </div>
      <div>
          <textarea id="msg" name="msg" placeholder="Write some message ..." style="height:100px"></textarea>
      </div>
      <div id="smsDiv">

      </div>
        <div>
          <input type="button" id="bt" value="Request a Taxi and Send me an SMS " onclick="saveFile()" />

      </div>

  </div>

  </div>

</body>

</html>

<script>
  let saveFile = () => {
    var smstext ="";
      // Get the data from each element on the form.
    const name = document.getElementById('txtName');
      const age = document.getElementById('txtAge');
      const email = document.getElementById('txtEmail');
      const country = document.getElementById('selCountry');
      const msg = document.getElementById('msg');
      
      // This variable stores all the data.
      let data = 
          '\r Name: ' + name.value + ' \r\n ' + 
          'Phone Number: ' +age.value + ' \r\n ' + 
          'Email: ' + email.value + ' \r\n ' + 
          'Country: ' + country.value + ' \r\n ' + 
          'Message: ' + msg.value;
      
      // Convert the text to BLOB.
      const textToBLOB = new Blob([data], { type: 'text/plain' });
      const sFileName = 'C:\\Users\\mamalle\\Documents\\GitHub\\my-first-app\\formData.txt';	   // The file to save the data.

      let newLink = document.createElement("a");
      newLink.download = sFileName;

      if (window.webkitURL != null) {
          newLink.href = window.webkitURL.createObjectURL(textToBLOB);
        
        }
      else {
          newLink.href = window.URL.createObjectURL(textToBLOB);
          newLink.style.display = "none";
          document.body.appendChild(newLink);
      }
     // smstext= "<a class=\"sms\" id=\"sms\" href=\"sms://+"+email.value+"?body=Taxi reservation has been made for "+msg.value+"\">Send a SMS message</a>";
     calltext ="<a href=\"tel:"+email.value+"\">Call (312)972-5856<img class=\"taxi-image\" src=\"https://cabstartup.com/wp-content/uploads/2018/05/Yellow-Taxi-Banner.png\" class=\"aligncenter\" alt=\"\"></a>";  
     document.getElementById("smsDiv").innerHTML=calltext;
        alert(calltext);
        document.getElementById("sms").click();
        

      newLink.click(); 
  }
 

  function myFunction(cell_count) {
    var newId = "details" + cell_count;
    var x = document.getElementById(newId);

    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  }
  
  $(document).ready(function () {

    $('#load_event_data').click(function (){
      $.ajax({
        url: "Event.csv",
        crossDomain: true,
        success: function (data) {
          var employee_data = data.split(/\r?\n|\r/);
          var div_data;
          for (var count = 1; count < employee_data.length; count++) {
            var cell_data = employee_data[count].split("  @  ");
            var div_cell;

            for (var cell_count = 0; cell_count < cell_data.length; cell_count++) {

              if (cell_count === 5) {
                div_cell += '<div class="picture" onclick="myFunction(' + count + ')" id="picture' + count + '">' + cell_data[5] + '</div>';
                div_cell += '<div id ="name" class="name"> Name: ' + cell_data[3] + '</div>';
                div_cell += '<div id ="taxi" class="taxi">' + cell_data[6] + '</div></div>';
              }
              else if (cell_count === 1){
                  div_cell += '<div class="details" id="details' + count + '">';
                  div_cell+= '<div ><div> Date: ' + cell_data[1] + '</div>';
                }
              else if (cell_count === 2)
                div_cell += '<div> Time: ' + cell_data[2] + '</div>';
              else if (cell_count === 4)
                div_cell += '<div> Description: ' + cell_data[4] + '</div></div></div>';
            }
          }
          div_data += div_cell;
          $('#employee_table').html(div_data);
          $('#taxi_table').hide();
          $('#employee_table').show();
        }
      });
    });


//Taxi
$('#load_taxi_data').click(function (){

$.ajax({
        url: "TaxiList.csv",
        crossDomain: true,
        success: function (data) {
          var taxi_data = data.split(/\r?\n|\r/);
          var div_data;
          for (var count = 0; count < taxi_data.length; count++) {
           // var cell_data = taxi_data[count].split(",");
            var div_cell;

           // for (var cell_count = 0; cell_count < cell_data.length; cell_count++) 
           // {
              div_cell += '<div class="call-taxi">' + taxi_data[count] + '</div>';  
            //}
          div_data += div_cell;
          
        }
        $('#taxi_table').html(div_data);
      }
      });//end of taxi method
      $('#employee_table').hide();
      $('#taxi_table').show();


    });


    });
 // });
</script>