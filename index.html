<!DOCTYPE html>
<html>

<head>
  <title class="jumbotron">Take Me Places ! Taxi service for Senior Events near you </title>
  <!-- Bootstrap -->
  <link href="bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .hide {
      display: none;
    }

  

    .event-img {
      width: 300px;
      height: 300px;      
    }
.title{
  color:palegoldenrod;
  font-size: xx-large;
}
    .name {
      color: green;
      font-weight:bolder;
      font-size:xx-large;
    }


    .picture {
      border-width: 1em;
      border-style: groove;
      border-color: coral;
      width: 300px;
      height: 300px;
    }

    .taxi{
      font-size: x-large;
      font:xx-large;
      color:royalblue;
      border: 2em;
  
    }
    .taxi-image{
      height: 10em;
      width: 10em;
    }
    .call-taxi{
      border: 0.2em;
      border-style: dotted;
      font-size: xx-large;
      color: darkblue;
    }
    .display_content {
      display: block;
    }
    .sms {
      display: none;
    }
    .btn{
      box-sizing: border-box;
      color: azure;
      border-style:solid;
    }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
  <ul class="nav nav-pills" role="tablist">
      <li role="presentation" class="active"><a href="#">Home</a></li>
      <li role="presentation"><a href="#">Profile</a></li>
      <li role="presentation"><a href="#">Messages</a></li>
    </ul>
  <div class="container">
    <h1><span class="label label-info">Hello ! Welcome to Take Me Places App !! </span></h1></div>
    <br />
    <div class="panel panel-success">
        <div align="center" class="panel-heading"><h2>Senior Events near you</h2>
        </div>
          <div align="center" class="panel-body">

            <button type="button" name="load_taxi_data" id="load_taxi_data" class="btn btn-lg btn-success">Show Taxi List</button>
            <button type="button" name="load_event_data" id="load_event_data" class="btn btn-lg btn-primary">Show Events List</button>
    </div>
        <br />
    <div id="employee_table" class="container">
        

      
    </div>
    <div id="taxi_table">

    </div>

   

    <div id="callTaxi" class="jumbotron" style="display: none;" >
      <h2><span class="label label-info">Fill the form below to request a taxi</span></h2><br>
          <div  class="form-group">
        
                <!--Add few elements to the form-->

                <div class="row "> 
                  <span class="col-lg-2 btn btn-info">Name:</span> 
                  <input class="col-lg-2" type="text" id="txtName" placeholder="Enter your name" />
                </div>
                    <br>
                <div class="row"> 
                  <span class="col-lg-2 btn btn-info">Date and Time:</span>
                  <input class="col-lg-2" type="datetime-local" id="txtdatetime" placeholder="Select Date and Time" />
                </div>
                    <br>
                    <div class="row">
                      <span class="col-lg-2 btn btn-info">Your Email Address:</span><input class="col-lg-2" type="text" id="txtcustomeremail" placeholder="Provide your email address" />
                    </div>
                    <br>
                    
                      <input class="col-lg-2" type="text" id="description" style="display: none;" />
                    
                    <div class="row">
                      <span class="col-lg-2 btn btn-info">Pick Up Address:</span><input class="col-lg-2" type="text" id="txtAddress" placeholder="Enter your pickup address" />
                    </div>
                    <br>
                    <div class="row"><span class=" col-lg-2 btn btn-info">City:</span>
                        <select class="col-lg-2" id="selCity">
                            <option selected value="">-- Choose the City --</option>
                            <option value="Kildeer">Kildeer</option>
                            <option value="Barrington">Barrington</option>
                            <option value="Vernon Hills">Vernon Hills</option>
                            <option value="Long Grove">Long Grove</option>

                        </select>
                    </div>
                      <br>
                    <div class="row"><span class="col-lg-2 btn-sm btn-info">Taxi:</span>
                      <select class="col-lg-2" id="selecttaxi">
                          <option selected value="">-- Choose the Taxi --</option>
                          <option value="billybob@gmail.com">BillyBob</option>
                          <option value="calvin@outlook.com">CalvinKlein</option>
                          <option value="patel@brothers.com"> Patel Brothers</option>
                          <option value="mrmallela@outlook.com">Shawn Mendes</option>

                      </select>
                  </div>
                  <br>
                    <div class="row">
                      <span class="col-lg-2 btn-sm btn-info">Details:</span>
                      <textarea class="col-lg-2" id="msg" name="msg" placeholder="Write some message ..." style="height:100px"></textarea>
                    </div>
                      <div id="smsDiv" style="display: none;">

                      </div>
        <div>
          <br>
          <input class="btn btn-lg btn-success" type="button" id="bt" value="Request a Taxi and Send me an SMS " onclick=" submitTaxiForm()" />
        </div>

      </div>
    </div>
    </div>
</body>

</html>

<script>



function  submitTaxiForm(){
    var smstext ="";
      // Get the data from each element on the form.
    const name = document.getElementById('txtName');
      const datetime = document.getElementById('txtdatetime');
      const txtcustomeremail = document.getElementById('txtcustomeremail');
      const pickupaddress = document.getElementById('txtAddress');
      const city = document.getElementById('selCity');
      const msg = document.getElementById('msg');

      var description = encodeURIComponent( document.getElementById('description').value);
      var nameEncoded = encodeURIComponent("Taxi requested for: "+name.value);
      var msgEncoded = encodeURIComponent("Event Details \r"+msg.value) + description;

    const taxiemail = document.getElementById('selecttaxi');
    var emailLink = "<a id=\"sms\" href=mailto:"+taxiemail.value+"?Subject=\""+nameEncoded+"\"&body=\""+msgEncoded+"\"&cc="+txtcustomeremail.value+">Send Mail</a>";


     document.getElementById("smsDiv").innerHTML=emailLink;
        document.getElementById("sms").click();
        

      newLink.click(); 
  }
 

  function myFunction(cell_count) {
    var newId = "details" + cell_count;
    var x = document.getElementById(newId);

    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  }

  function callTaxi(eventname, date, description) {
    var x = document.getElementById('callTaxi');
    var y = document.getElementById('employee_table');

      document.getElementById('txtName').value = decodeURIComponent(eventname);
      document.getElementById('txtdatetime').value = decodeURIComponent(date);
      document.getElementById('description').value = decodeURIComponent(description);

    if (x.style.display === "none") {
      x.style.display = "block";
      y.style.display = "none";

    } else {

      x.style.display = "none";
      y.style.display = "block";

    }
  }
  
  $(document).ready(function () {

    $('#load_event_data').click(function (){
      $.ajax({
        url: "Event.csv",
        crossDomain: true,
        success: function (data) {
          var employee_data = data.split(/\r?\n|\r/);
          var div_data;
          for (var count = 0; count < employee_data.length; count++) {
            var cell_data = employee_data[count].split("  @  ");
            var div_cell;

              div_cell += '<div class="row"><div class="col-lg-6"><div class="jumbotron" id="picture' + count + '"><img class="img-thumbnail" style="height:300px;width:300px"  src=" ' + cell_data[5] + ' "></div></div>';

              div_cell += '<div class="col-lg-6">';
                document.getElementById('txtName').value = cell_data[3];
                div_cell += '<div id ="name" class="panel panel-primary"><div class="panel-heading">' + cell_data[3] + '</div></div>';
                div_cell += '<button id ="taxi" onclick="callTaxi(\''+encodeURIComponent(cell_data[3])+'\',\''+encodeURIComponent(cell_data[2])+'\',\'' +encodeURIComponent(cell_data[4])    +    '\')" class="label-md label-warning">' + "Request a Taxi" + '</button><br>';
                
                div_cell+= '<pre><div class="well" id="details' + count + '"><span class="text-primary "> It\'s on ' + cell_data[1] + '</span>';
                div_cell += '<span class="text-success"> At ' + cell_data[2] + '</span><hr>';
                div_cell += '<span class="text-info">' + cell_data[4] + '</span></div></div></div>';
          }
          div_data += div_cell;
          $('#employee_table').html(div_data);
          $('#taxi_table').hide();
          $('#employee_table').show();
        }
      });
    });


//Taxi
$('#load_taxi_data').click(function (){

$.ajax({
        url: "TaxiList.csv",
        crossDomain: true,
        success: function (data) {
          var taxi_data = data.split(/\r?\n|\r/);
          var div_data;
          for (var count = 0; count < taxi_data.length; count++) {
           // var cell_data = taxi_data[count].split(",");
            var div_cell;
            div_cell += '<div class="jumbotron"><h2>' + taxi_data[count] + '</h2> </div>';  
          
        }
        div_data += div_cell;
          
        $('#taxi_table').html(div_data);
      }
      });//end of taxi method
      $('#employee_table').hide();
      $('#taxi_table').show();


    });


    });
 // });
</script>
